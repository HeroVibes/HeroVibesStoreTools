<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kits Tool</title>
  <style>
    /* ===== DESIGN SYSTEM ===== */
    :root {
      --bg-primary: #191919;
      --bg-secondary: #1F1F1F;
      --bg-hover: #323232;
      --outline: #323232;
      --accent: #87A9FF;
      --text-primary: #D4D4D4;
      --text-secondary: #8C8C8C;
      --radius: 8px;
      --green: #4CAF50;
      --blue: #87A9FF;
      --red: #F44336;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      padding: 24px 16px;
      overflow-x: hidden;
    }

    /* ===== MAIN CONTAINER ===== */
    #app {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* ===== KITS GRID (MAIN PAGE) ===== */
    #main-page {
      animation: fadeIn 0.3s ease;
    }

    #kits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
      margin-top: 24px;
    }

    /* ===== KIT CARD ===== */
    .kit-card {
      position: relative;
      background: var(--bg-secondary);
      border: 1px solid var(--outline);
      border-radius: var(--radius);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .kit-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 75%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
      transform: skewX(-25deg);
      transition: left 0.7s ease-in-out;
      z-index: 1;
    }

    .kit-card:hover {
      background: var(--bg-hover);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }

    .kit-card:hover::before {
      left: 125%;
    }

    .kit-card-thumbnail {
      width: 100%;
      aspect-ratio: 16 / 9;
      background: var(--bg-primary);
      overflow: hidden;
      position: relative;
    }

    .kit-card-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }

    .kit-card:hover .kit-card-thumbnail img {
      transform: scale(1.05);
    }

    .kit-card-content {
      padding: 16px;
    }

    .kit-card h3 {
      font-size: 20px;
      font-weight: bold;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .kit-card-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .kit-card-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* ===== KIT DETAIL PAGE ===== */
    #kit-detail {
      animation: fadeIn 0.3s ease;
    }

    #back-button {
      position: relative;
      padding: 10px 16px;
      border-radius: var(--radius);
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid rgba(255,255,255,0.06);
      cursor: pointer;
      overflow: hidden;
      font-size: 14px;
      margin-bottom: 24px;
      transition: all 0.2s ease;
    }

    #back-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 75%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
      transform: skewX(-25deg);
      transition: left 0.7s ease-in-out;
    }

    #back-button:hover {
      background: var(--bg-hover);
    }

    #back-button:hover::before {
      left: 125%;
    }

    #back-button:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(135,169,255,0.12);
    }

    #kit-title {
      font-size: 20px;
      font-weight: bold;
      color: var(--text-primary);
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--outline);
    }

    /* ===== PRODUCT ITEMS ===== */
    #kit-items {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 24px;
    }

    .item-card {
      background: var(--bg-secondary);
      border: 1px solid var(--outline);
      border-radius: var(--radius);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: all 0.3s ease;
    }

    .item-card:hover {
      border-color: rgba(135, 169, 255, 0.3);
      box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    }

    .item-image-container {
      width: 100%;
      aspect-ratio: 16 / 9;
      background: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }

    .item-image-container::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, transparent 60%, rgba(25,25,25,0.8));
      pointer-events: none;
    }

    .item-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }

    .item-card:hover img {
      transform: scale(1.05);
    }

    .item-info {
      padding: 24px 16px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .item-info h4 {
      font-size: 14px;
      font-weight: bold;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .item-info p {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 16px;
      flex-grow: 1;
    }

    /* ===== BUTTON GROUPS ===== */
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .video-review-container {
      padding-top: 8px;
      border-top: 1px solid var(--outline);
      margin-top: 8px;
    }

    /* ===== PURCHASE BUTTONS ===== */
    .btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 16px;
      border-radius: var(--radius);
      color: #fff;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      border: 1px solid rgba(255,255,255,0.1);
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s ease;
      flex: 1;
      min-width: fit-content;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 75%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
      transform: skewX(-25deg);
      transition: left 0.7s ease-in-out;
    }

    .btn:hover::before {
      left: 125%;
    }

    .btn:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(135,169,255,0.12);
    }

    .btn-official {
      background: var(--green);
    }

    .btn-official:hover {
      background: #45a049;
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
      transform: translateY(-1px);
    }

    .btn-uk {
      background: var(--blue);
    }

    .btn-uk:hover {
      background: #6B8FE8;
      box-shadow: 0 4px 12px rgba(135, 169, 255, 0.3);
      transform: translateY(-1px);
    }

    .btn-us {
      background: var(--red);
    }

    .btn-us:hover {
      background: #da190b;
      box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
      transform: translateY(-1px);
    }

    /* ===== VIDEO REVIEW BUTTON ===== */
    .btn-video {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--outline);
      font-size: 12px;
      padding: 8px 12px;
      align-self: flex-start;
    }

    .btn-video:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
      border-color: rgba(135, 169, 255, 0.3);
    }

    /* ===== DISCLAIMER ===== */
    .disclaimer {
      font-size: 11px;
      color: var(--text-secondary);
      text-align: center;
      padding: 16px;
      margin-top: 24px;
      border-top: 1px solid var(--outline);
      line-height: 1.5;
    }

    .disclaimer a {
      color: var(--accent);
      text-decoration: none;
      transition: opacity 0.2s ease;
    }

    .disclaimer a:hover {
      opacity: 0.8;
      text-decoration: underline;
    }

    /* ===== UTILITY CLASSES ===== */
    .hidden {
      display: none !important;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (min-width: 640px) {
      .item-card {
        flex-direction: row;
      }

      .item-image-container {
        width: 320px;
        min-width: 320px;
      }

      .item-image-container::after {
        background: linear-gradient(to right, transparent 60%, rgba(25,25,25,0.8));
      }
    }

    @media (max-width: 639px) {
      body {
        padding: 16px 12px;
      }

      #kits-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .kit-card-content {
        padding: 12px;
      }

      .item-info {
        padding: 20px 12px;
      }

      .button-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- ===== MAIN PAGE: KITS GRID ===== -->
    <div id="main-page">
      <div id="kits-grid"></div>
    </div>

    <!-- ===== DETAIL PAGE: KIT ITEMS ===== -->
    <div id="kit-detail" class="hidden">
      <button id="back-button">‚Üê Back to Kits</button>
      <h2 id="kit-title"></h2>
      <div id="kit-items"></div>
      <div class="disclaimer">
        Some of the links on this page may be affiliate links, which means we may earn a small commission if you make a purchase. 
        This helps support the website at no extra cost to you. 
        <a href="https://12boom.com/2024/09/17/affiliate-links/" target="_blank" rel="noopener noreferrer">Learn more about affiliate links</a>.
      </div>
    </div>
  </div>

  <script>
    // ===== KITS DATA =====
    // TO ADD A NEW KIT: Copy the template below and add it to the array
    // DIRECT LINK FORMAT: Add ?kit=SLUG_NAME to your page URL (e.g., ?kit=travel-backpack)
    const kits = [
      {
        title: "The Travelling Vlogger",
        slug: "travel-backpack",
        thumbnailLink: "https://herovibes.github.io/HeroVibesStoreTools/Kits/Pictures/SonyZV-E1.webp",
        itemCount: 4,
        items: [
          {
            name: "Sony ZV-E1",
            image: "https://herovibes.github.io/HeroVibesStoreTools/Kits/Pictures/SonyZV-E1.webp",
            description: "Full-frame mirrorless camera with exceptional image quality and autofocus performance.",
            linkOfficial: "",
            linkUK: "https://amzn.to/4og2wBn",
            linkUS: "https://amzn.to/4nZdKKh",
            videoReview: ""
          },
          {
            name: "Sigma 28-70 f2.8 Lens",
            image: "https://herovibes.github.io/HeroVibesStoreTools/Kits/Pictures/Sigma28-70.webp",
            description: "A beautiful lens with remarkable bokeh and image quality - perfect for vlogs and cinematics.",
            linkOfficial: "",
            linkUK: "https://amzn.to/4hgUIfC",
            linkUS: "https://amzn.to/3KVTjzm",
            videoReview: ""
          },
          {
            name: "Hollyland Lark M2 Wireless Lavs",
            image: "https://herovibes.github.io/HeroVibesStoreTools/Kits/Pictures/HollylandLarkM2.webp",
            description: "Simple and easy-to-use lav mics that work both with your camera and your phone.",
            linkOfficial: "",
            linkUK: "https://amzn.to/4mZeIoq",
            linkUS: "https://amzn.to/4oeoC6M",
            videoReview: ""
          },
          {
            name: "Elgato Keylight Neo",
            image: "https://herovibes.github.io/HeroVibesStoreTools/Kits/Pictures/ElgatoKeylightNeo.webp",
            description: "A portable light with variable brightness and temperature settings - when paired with a suitable powerbank, can run for hours and be taken anywhere",
            linkOfficial: "https://elgato.sjv.io/o4OAoe",
            linkUK: "https://amzn.to/43RyLPs",
            linkUS: "https://amzn.to/3GamnAV",
            videoReview: ""
          }
        ]
      }
      // ===== ADD MORE KITS HERE =====
      // Template for new kit:
      // {
      //   title: "Kit Name",
      //   slug: "kit-url-slug",
      //   thumbnailLink: "https://your-image-url.com/image.jpg",
      //   itemCount: 3,
      //   items: [
      //     {
      //       name: "Product Name",
      //       image: "https://product-image.jpg",
      //       description: "Product description here",
      //       linkOfficial: "https://official-store-link.com",  // Leave empty "" to hide
      //       linkUK: "https://amazon.co.uk/link",              // Leave empty "" to hide
      //       linkUS: "https://amazon.com/link",                // Leave empty "" to hide
      //       videoReview: "https://youtube.com/watch?v=xxx"    // Leave empty "" to hide
      //     }
      //   ]
      // }
    ];

    // ===== DOM ELEMENTS =====
    const grid = document.getElementById("kits-grid");
    const mainPage = document.getElementById("main-page");
    const detailPage = document.getElementById("kit-detail");
    const kitTitle = document.getElementById("kit-title");
    const kitItems = document.getElementById("kit-items");
    const backButton = document.getElementById("back-button");

    // ===== LOAD KITS GRID =====
    function loadKits(start = 0, count = 12) {
      for (let i = start; i < start + count && i < kits.length; i++) {
        const kit = kits[i];
        const card = document.createElement("div");
        card.className = "kit-card";
        card.innerHTML = `
          <div class="kit-card-thumbnail">
            <img src="${kit.thumbnailLink}" alt="${kit.title}" loading="lazy">
          </div>
          <div class="kit-card-content">
            <h3>${kit.title}</h3>
            <div class="kit-card-meta">
              <span>üì¶ ${kit.itemCount} items</span>
            </div>
          </div>
        `;
        card.onclick = () => openKit(kit.slug);
        grid.appendChild(card);
      }
    }

    // ===== OPEN KIT DETAIL =====
    function openKit(slug) {
      const kit = kits.find(k => k.slug === slug);
      if (!kit) return;

      kitTitle.textContent = kit.title;
      kitItems.innerHTML = "";

      kit.items.forEach(item => {
        const itemCard = document.createElement("div");
        itemCard.className = "item-card";
        
        // Build purchase buttons HTML
        let buttonsHTML = '<div class="button-group">';
        
        if (item.linkOfficial) {
          buttonsHTML += `
            <a href="${item.linkOfficial}" target="_blank" rel="noopener noreferrer" class="btn btn-official">
              <span>Official Store</span>
              <span>‚Üí</span>
            </a>
          `;
        }
        
        if (item.linkUK) {
          buttonsHTML += `
            <a href="${item.linkUK}" target="_blank" rel="noopener noreferrer" class="btn btn-uk">
              <span>Buy on Amazon UK</span>
              <span>‚Üí</span>
            </a>
          `;
        }
        
        if (item.linkUS) {
          buttonsHTML += `
            <a href="${item.linkUS}" target="_blank" rel="noopener noreferrer" class="btn btn-us">
              <span>Buy on Amazon US</span>
              <span>‚Üí</span>
            </a>
          `;
        }
        
        buttonsHTML += '</div>';
        
        // Add video review button if available
        let videoHTML = '';
        if (item.videoReview) {
          videoHTML = `
            <div class="video-review-container">
              <a href="${item.videoReview}" target="_blank" rel="noopener noreferrer" class="btn btn-video">
                <span>üé•</span>
                <span>Watch Video Review</span>
              </a>
            </div>
          `;
        }
        
        itemCard.innerHTML = `
          <div class="item-image-container">
            <img src="${item.image}" alt="${item.name}" loading="lazy">
          </div>
          <div class="item-info">
            <h4>${item.name}</h4>
            <p>${item.description}</p>
            ${buttonsHTML}
            ${videoHTML}
          </div>
        `;
        kitItems.appendChild(itemCard);
      });

      // Update URL without page reload
      const newUrl = `${window.location.pathname}?kit=${slug}`;
      window.history.pushState({ slug }, "", newUrl);
      
      mainPage.classList.add("hidden");
      detailPage.classList.remove("hidden");
      scheduleHeightCheck();
    }

    // ===== BACK TO KITS =====
    backButton.onclick = () => {
      window.history.pushState({}, "", window.location.pathname);
      mainPage.classList.remove("hidden");
      detailPage.classList.add("hidden");
      scheduleHeightCheck();
    };

    // ===== HANDLE BROWSER NAVIGATION =====
    window.addEventListener("popstate", (event) => {
      const urlParams = new URLSearchParams(window.location.search);
      const slug = urlParams.get('kit');
      
      if (slug) {
        openKit(slug);
      } else {
        mainPage.classList.remove("hidden");
        detailPage.classList.add("hidden");
        scheduleHeightCheck();
      }
    });

    // ===== INITIALIZE =====
    // Check if there's a kit in the URL on page load (works in iframes!)
    const urlParams = new URLSearchParams(window.location.search);
    const initialSlug = urlParams.get('kit');
    
    if (initialSlug) {
      openKit(initialSlug);
    } else {
      loadKits();
    }

    // ===== OPTIONAL: INFINITE SCROLL =====
    window.addEventListener("scroll", () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
        if (!detailPage.classList.contains("hidden")) {
          return; // Don't load more kits while viewing a kit detail
        }
        if (grid.childElementCount < kits.length) {
          loadKits(grid.childElementCount, 6);
          scheduleHeightCheck();
        }
      }
    });
  </script>

  <script>
    // ===== FOURTHWALL SCROLLBAR FIX =====
    let lastHeight = 0;
    let resizeTimer;

    function sendHeight() {
      const height = document.body.scrollHeight;
      
      if (height !== lastHeight) {
        lastHeight = height;
        window.parent.postMessage({ frameHeight: height }, '*');
      }
    }

    function scheduleHeightCheck() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(sendHeight, 150);
    }

    window.addEventListener('load', () => {
      setTimeout(sendHeight, 100);
    });

    window.addEventListener('resize', () => {
      scheduleHeightCheck();
    });
    // ===== END OF SCROLLBAR FIX =====
  </script>
</body>
</html>
